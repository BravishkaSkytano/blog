{% assign pinned_posts = site.posts | where: "pinned","true" %}
{% if pinned_posts.size > 0 %}
<div class="posts">
  <div class="content-subhead">Pinned Posts</div>
  {% for post in pinned_posts %}
  <section class="post">
    <header class="post-header">
      <h1 class="post-title">
        <a href="{{ post.url }}">
          {{ post.title }}
        </a>
      </h1>

      <div class="post-meta pure-g">
        <div class="pure-u-1 pure-u-md-1-3">
          {{ post.date | date: "%b %d, '%y" }}
          <svg id="i-clock" viewBox="0 0 32 32" width="20" height="20" fill="none" stroke="currentcolor" stroke-linecap="round"
            stroke-linejoin="round" stroke-width="2"><circle cx="16" cy="16" r="14" /><path d="M16 8 L16 16 20 20" /></svg>
          {% assign words = post.content | number_of_words %}
          {% if words < 360 %}
            1 min read.
          {% else %}
            {{ words | divided_by:180 }} mins read.
          {% endif %}
        </div>
        {% if post.category %}
        <div class="pure-u-1 pure-u-md-1-3">
          <a class="capitalize" href="{{ '/categories.html' | relative_url }}#{{ post.category | slugify }}">
            {{ post.category | replace: "-", " " }}
          </a>
        </div>
        {% endif %}{% if post.tags %}
        <div class="pure-u-1 pure-u-md-1-3">
          {% for tag in post.tags %}
          <a class="badge" href="{{ '/tags.html' | relative_url }}#{{ tag | slugify }}">
            #{{ tag }}
          </a>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </header>

    <div class="post-description">
      {{ post.content | truncate: 280 }} <a href="{{ post.url }}">Read more.</a>
    </div>
  </section>
  {% endfor %}
</div>
{% endif %}

<div class="posts">
  <div class="content-subhead">Recent Posts</div>
  {% assign posts = site.posts | where: "pinned", null %}
  {% for post in posts limit: page.limit %}
  <section class="post">
    <header class="post-header">
      <h1 class="post-title">
        <a href="{{ post.url }}">
          {{ post.title }}
        </a>
      </h1>

      <div class="post-meta pure-g">
        <div class="pure-u-1 pure-u-md-1-3">
          {{ post.date | date: "%b %d, %y" }}
          <svg id="i-clock" viewBox="0 0 32 32" width="20" height="20" fill="none" stroke="currentcolor" stroke-linecap="round"
            stroke-linejoin="round" stroke-width="2"><circle cx="16" cy="16" r="14" /><path d="M16 8 L16 16 20 20" /></svg>
          {% assign words = post.content | number_of_words %}
          {% if words < 360 %}
            1 min read.
          {% else %}
            {{ words | divided_by:180 }} mins read.
          {% endif %}
        </div>
        {% if post.category %}
        <div class="pure-u-1 pure-u-md-1-3">
          <a class="capitalize" href="{{ '/categories.html' | relative_url }}/#{{ post.category | slugify }}">
            {{ post.category | replace: "-", " " }}
          </a>
        </div>
        {% else if post.book %}
        <div class="pure-u-1 pure-u-md-1-3">
          <a href="{{ '/books.html' | relative_url }}/#{{ post.book }}">
            {{ site.data.books | where: 'id', post.book | map: 'title' }}
          </a>
        </div>
        {% endif %}{% if post.tags %}
        <div class="pure-u-1 pure-u-md-1-3">
          {% for tag in post.tags %}
          <a class="badge" href="{{ '/tags.html' | relative_url }}/#{{ tag | slugify }}">
            #{{ tag }}
          </a>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </header>

    <div class="post-description">
      {{ post.content | truncate: 280 }} <a href="{{ post.url }}">Read more.</a>
    </div>
  </section>
  {% endfor %}
</div>